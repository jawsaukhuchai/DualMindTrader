name: ğŸ“ˆ DualMindTrader Benchmarks

on:
  # âœ… Manual trigger à¸ˆà¸²à¸à¸«à¸™à¹‰à¸² Actions
  workflow_dispatch:

permissions:
  contents: read

jobs:
  benchmark:
    name: âš™ï¸ Run Benchmarks & Upload Results
    runs-on: ubuntu-latest
    timeout-minutes: 30  # à¸à¸±à¸™à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸£à¸±à¸™à¸„à¹‰à¸²à¸‡à¹€à¸à¸´à¸™à¹„à¸›

    steps:
      - name: ğŸ“¦ Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ§° Set up Python 3.9
        uses: actions/setup-python@v5
        with:
          python-version: "3.9"

      - name: ğŸ§© Install dependencies
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
          pip install pytest pytest-cov

      - name: ğŸ§  Run benchmark tests only
        run: |
          echo "ğŸš€ Running DualMindTrader Benchmarks..."
          pytest -m benchmark -s || true  # à¸£à¸±à¸™ benchmark à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” à¹à¸•à¹ˆà¹„à¸¡à¹ˆ fail job à¸–à¹‰à¸² benchmark à¹€à¸à¸´à¸™ threshold

      - name: ğŸ“Š Upload benchmark results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: benchmark-results-${{ github.run_number }}
          path: benchmarks/results/
          retention-days: 60  # à¹€à¸à¹‡à¸šà¸œà¸¥à¹„à¸§à¹‰ 60 à¸§à¸±à¸™

      - name: ğŸ“ Summary log
        if: always()
        run: |
          echo "âœ… Benchmark completed."
          echo "ğŸ“Š Results uploaded as artifact: benchmark-results-${{ github.run_number }}"
          echo "ğŸ•’ Timestamp: $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
